<!DOCTYPE html>
<html>
<head>
    <title>アンケートフォーム</title>
    <base target="_top">  
    <style>
        body { background-color: #ffffe0; }
        .form-section { margin-bottom: 20px; }
        label, input, select, textarea {
            display: block;
            margin-bottom: 10px;
        }
        textarea { width: 100%; height: 100px; }
        input[type="submit"] { margin-top: 20px; }
    </style>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
        function initializeLiff() {
            liff.init({ liffId: "2002419122-9vb67yoY" })
                .then(() => {
                    if (!liff.isLoggedIn()) {
                        liff.login();
                    }
                })
                .catch((err) => {
                    console.error('LIFF Initialization failed', err);
                });
        }

        function handleFormSubmit(formElement) {
            google.script.run
                .withSuccessHandler(onSuccess)
                .withFailureHandler(onFailure)
                .processForm(formElement);

            return false; // Prevent default form submission
        }

        function onFailure(error) {
            console.error("Error:", error);
            alert("エラーが発生しました。");
        }

        function onSuccess(html) {
            document.open();
            document.write(html);
            document.close();
        }

        window.onload = function() {
            initializeLiff();
        }
    </script>
</head>
<body>
    <form id="survey-form" enctype="multipart/form-data" onsubmit="return handleFormSubmit(this)">
        <!-- Form content here -->
    </form>
</body>
</html>
